"use strict";var mesureWidth=function(e){var t=0,n=$(window).width(),o=e.closest(".recipes").find(".recipes__title"),i=o.width()*o.length,a=e.find(".recipes__container"),r=parseInt(a.css("padding-left")),s=parseInt(a.css("padding-right"));return{container:t=window.matchMedia("(max-width: 768px)").matches?n-i:500,textContainer:t-r-s}},closeEveryItemInContainer=function(e){var t=e.find(".recipes__item"),n=e.find(".recipes__description");t.removeClass("active"),n.width(0)},openItemAccord=function(e){var t=e.find(".recipes__description"),n=mesureWidth(e),o=e.find(".recipes__container");e.addClass("active"),t.width(n.container),o.width(n.textContainer)};$(".recipes__title").on("click",function(e){e.preventDefault();var t=$(e.currentTarget),n=t.closest(".recipes__item"),o=n.hasClass("active"),i=t.closest(".recipes");o?closeEveryItemInContainer(i):(closeEveryItemInContainer(i),openItemAccord(n))}),$(".recipes__close").on("click",function(e){e.preventDefault(),closeEveryItemInContainer($(".recipes"))});var myMap,openItem=function(e){var t=e.closest(".team__member"),n=t.find(".member__content"),o=n.find(".member__content-block").height();t.addClass("active"),n.height(o)},closeEveryItem=function(e){var t=e.find(".member__content");e.find(".team__member").removeClass("active"),t.height(0)};$(".member__name").click(function(e){var t=$(e.currentTarget),n=t.closest(".team");t.closest(".team__member").hasClass("active")?closeEveryItem(n):(closeEveryItem(n),openItem(t))});var init=function(){myMap=new ymaps.Map("map",{center:[55.753969,37.606673],zoom:14,controls:[]});var t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/icons/marker.svg",iconImageSize:[46,57],iconImageOffset:[-35,-52]});[[55.763183,37.582547],[55.741035,37.573998],[55.746456,37.608084],[55.761756,37.61833]].forEach(function(e){t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")};ymaps.ready(init);var menu=document.querySelector(".menu"),hamburger=document.querySelector(".hamburger");hamburger.addEventListener("click",function(e){e.preventDefault(),menu.classList.add("menu--mobile"),hamburger.classList.add("hamburger--close"),hamburger.addEventListener("click",function(e){menu.classList.toggle("menu--mobile"),hamburger.classList.toggle("hamburger--close")})});var validateFields=function(e,t){return t.forEach(function(e){e.removeClass("input-eror"),""===e.val().trim()&&e.addClass("input-eror")}),0===e.find(".input-eror").length};$(".form").submit(function(e){e.preventDefault();var t,n=$(e.currentTarget),o=n.find("[name='name']"),i=n.find("[name='phone']"),a=n.find("[name='comment']"),r=n.find("[name='to']"),s=$("#modal"),l=s.find(".modal__content");s.removeClass("error-modal"),validateFields(n,[o,i,a,r])&&((t=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:o.val(),phone:i.val(),comment:a.val(),to:r.val()}})).done(function(e){l.text(e.message)}),t.fail(function(e){var t=e.responseJSON.message;l.text(t),s.addClass("error-modal")}),t.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-close-modal").click(function(e){e.preventDefault(),$.fancybox.close()});var sections=$("section"),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1;sections.first().addClass("active");var countSectionPosition=function(e){var t=-100*e;return isNaN(t)?(console.error("передано не верное значение в countSectionPosition"),0):t},chageMenuThemeForSection=function(e){var t="fixed-menu--shadowed";"black"==sections.eq(e).attr("data-sidemenu-theme")?sideMenu.addClass(t):sideMenu.removeClass(t)},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),chageMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},1300))},viewportScroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}};$(window).on("wheel",function(e){var t=e.originalEvent.deltaY,n=viewportScroller();0<t&&n.next(),t<0&&n.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),n="input"==t||"textarea"==t,o=viewportScroller();if(!n)switch(e.keyCode){case 38:o.prev();break;case 40:o.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-scroll-to"),n=$("[data-section-id=".concat(t,"]"));performTransition(n.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewportScroller()["down"==t?"prev":"up"==t?"next":""]()}});var slider=$(".sliders__list").bxSlider({pager:!1,controls:!1});$(".sliders__arrow--left").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".sliders__arrow--right").click(function(e){e.preventDefault(),slider.goToNextSlide()});var video,durationControl,soundControl,intervalId,findBlockByAlias=function(n){return $(".reviews__content").filter(function(e,t){return $(t).attr("data-linked-with")==n})};function playStop(){document.querySelector(".video__play").classList.toggle("video__play--active"),durationControl.max=video.duration,video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/66)):(video.pause(),clearInterval(intervalId))}function updateDuration(){durationControl.value=video.currentTime}function stopInterval(){video.pause(),clearInterval(intervalId)}function setVideoDuration(){video.paused?video.play():video.pause(),video.currentTime=durationControl.value,intervalId=setInterval(updateDuration,1e3/66)}function changeSoundVolume(){video.volume=soundControl.value/10}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel):(soundLevel=video.volume,video.volume=0,soundControl.value=0)}$(".interactive-avatar__link").click(function(e){e.preventDefault();var t=$(e.currentTarget),n=t.attr("data-open"),o=findBlockByAlias(n),i=t.closest(".interactive-avatar");o.addClass("active").siblings().removeClass("active"),i.addClass("active").siblings().removeClass("active")}),document.addEventListener("DOMContentLoaded",function(e){(video=document.getElementById("video")).addEventListener("click",playStop);for(var t=document.querySelectorAll(".play"),n=0;n<t.length;n++)t[n].addEventListener("click",playStop);document.getElementById("micLevel").addEventListener("click",soundOf),(durationControl=document.getElementById("durationLevel")).addEventListener("mousedown",stopInterval),durationControl.addEventListener("click",setVideoDuration),durationControl.min=0,durationControl.value=0,(soundControl=document.getElementById("volumeLevel")).addEventListener("click",changeSoundVolume),soundControl.addEventListener("mouseup",changeSoundVolume),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max});